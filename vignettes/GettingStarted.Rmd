---
title: "Getting Started with finsyncR"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Getting Started}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor_options:
  markdown:
    wrap: sentence
---

<style>
    img {
        border: 0;
    }
</style>

# Introduction

United States (US) federal biomonitoring programs exist to assess the state of freshwater communities.
These programs use standardized sampling protocols to produce data that is unparalleled in terms of spatial extent, temporal scope, and diversity of taxa surveyed.
These data are used by the US government in assessment frameworks, but a wealth of additional knowledge can be gleaned from unique applications of these data.
While most data associated with these biomonitoring efforts are publicly available, barriers remain for new, outside users to apply these data without institutional guidance.

`finsyncR` (**f**ish and **in**vertebrate **sync**hronizer in **R**) is an R package that flexibly acquires, processes, and integrates national-level aquatic biomonitoring datasets in the US, with a focus on fish and macroinvertebrates in rivers and streams.
The package streamlines the process of retrieving and harmonizing these data, improving access to cleaned data and making the application of these data straightforward for researchers.
The sources of data for this package are the United States Environmental Protection Agency's (USEPA) National Aquatic Resource Surveys (NARS), namely the National River and Streams Assessment (NRSA), and United States Geological Survey's (USGS) BioData.

The package provides abundance and occurrence data for fish and macroinvertebrates at a variety of levels of taxonomic resolution.
The package provides flexibility for common data integration and processing issues for temporal biologic datasets.
Data management options include harmonization of macroinvertebrate taxonomy across the two federal sources of data and through time, and the option to drop hybrid organisms altogether for fish.
Macroinvertebrate samples, which often vary in the number of individuals can be rarefied to a user specified count.
Additionally, fish samples can be standardized to catch per-unit effort and to account for catchability differences between fish sampling methods.
The package can also match sampling sites for fish and macroinvertebrates to data from the National Land Cover Database.

In this Getting Started Vignette, we guide users on how to use the package and on certain nuances of the data that could influence analyses, in some instances.
In particular, we describe the spatial sampling designs, the timing and frequency of monitoring efforts, variation in sampling efforts (e.g. sampling area and proportion of samples identified), and improvements in taxonomic identifications through time in some orders of macroinvertebrates.
Potential uses of the data include studies of changes in fish and macroinvertebrate communities across space and time and the environmental causes and ecological consequences of those changes (see [Table 1](#Table1)).

<br>
<a id="Table1"></a>
**Table 1.** Example code to generate macroinvertebrates and fish datasets given hypothetical research questions.

| Research question | Output dataset requested | Macroinvertebrates | Fish |
|:-----------------|:-----------------|----------------------:|----------------------:|
| How does density/CPUE change through time across EPA and USGS samples? | Density/CPUE at sites for lowest taxonomic resolution, with shared taxa only, removing hybrid fish, and excluding boatable streams/rivers | `getInvertData(dataType = "abun",` <br> `taxonLevel = "Genus",` <br> `taxonFix = "lump",` <br> `agency = c("USGS","EPA"),` <br> `lifestage = FALSE,` <br> `rarefy = FALSE,` <br> `sharedTaxa = TRUE,` <br> `seed = 0,` <br> `boatableStreams = FALSE)` | `getFishData(dataType = "abun",` <br> `taxonLevel = "Species",` <br> `agency = c("USGS","EPA"),` <br> `standardize = "CPUE",` <br> `hybrids = FALSE,` <br> `sharedTaxa = TRUE,` <br> `boatableStreams = FALSE)` |
| How does the composition of families differ between EPA and USGS samples? | Occurrence at sites for Family resolution, with all taxa, rarefying macroinvertebrate counts to 300 individuals, and excluding boatable streams/rivers | `getInvertData(dataType = "occur",` <br> `taxonLevel = "Family",` <br> `taxonFix = "none",` <br> `agency = c("USGS","EPA"),` <br> `lifestage = FALSE,` <br> `rarefy = TRUE,`<br> `rarefyCount = 300,` <br> `sharedTaxa = FALSE,` <br> `seed = 1,` <br> `boatableStreams = FALSE)` | `getFishData(dataType = "occur",` <br> `taxonLevel = "Family",` <br> `agency = c("USGS","EPA"),` <br> `standardize = "none",` <br> `sharedTaxa = FALSE,` <br> `boatableStreams = FALSE)`
| What are spatial occupancy patterns within the Upper-Midwest Ecoregion using the randomized sampling design of the EPA NARS? | Occurrence for  lowest taxonomic resolution for only EPA samples, then filtered to the UWM Ecoregion | `getInvertData(dataType = "occur",` <br> `taxonLevel = "Family",` <br> `taxonFix = "none",` <br> `agency = c("EPA"),` <br> `rarefy = TRUE,`<br> `rarefyCount = 500,` <br> `sharedTaxa = FALSE,` <br> `seed = 1,` <br> `boatableStreams = TRUE) %>%` <br> `filter(NARS_Ecoregion == "UMW")` | `getFishData(dataType = "occur",` <br> `taxonLevel = "Family",` <br> `agency = c("EPA"),` <br> `standardize = "none",` <br> `sharedTaxa = FALSE,` <br> `boatableStreams = TRUE) %>%` <br> `filter(NARS_Ecoregion == "UMW")` |

<br>

Data from USGS BioData were obtained from Pete Ruhl ([pmruhl\@usgs.gov](mailto:pmruhl@usgs.gov){.email}) and are stored internally, and data from the National Aquatic Resource Surveys are directly downloaded by the package from the website: <https://www.epa.gov/national-aquatic-resource-surveys/data-national-aquatic-resource-surveys>.


```r
library(devtools)
##install the finsyncR package
devtools::install_github("USEPA/finsyncR",
                         build_vignette = TRUE)
```

```r
##Read in the finsyncR package
library(finsyncR)
```

# Biotic Datasets

The package is organized into two groups of functions, namely functions that generate biotic and abiotic datasets.
Two functions generate biotic datasets: `getInvertData()` and `getFishData()`, which generate community matrices for macroinvertebrates and fish, respectively.
The data management workflow for these functions generally follows three major steps: acquiring data and initial formatting, processing data separately by agency, and finally integrating data between USEPA and USGS sources ([Figure 1](#Figure1)).

<br>
<a id="Figure1"></a>
<img src="https://github.com/mahonmb/Misc/blob/main/WorkFlow.png?raw=TRUE" alt="\label{pizzhat}**Figure 1**. Workflow diagram of the simplified data management steps used in the construction of community matrices for macroinvertebrates, `getInvertData()`, and fish, `getfishData()`. Function parameters specified in each step of data management are provided." width="700px" style="display: block; margin: auto;" />

<br>

## Macroinvertebrates

`getInvertData()` retrieves, cleans, and compiles the stream macroinvertebrate datasets collected by the USGS and USEPA.
The function harmonizes taxonomy of macroinvertebrates across agencies and through time.
In addition, it accounts for differences in sample splitting, which vary by agency.
The parameters in the `getInvertData()` function are `dataType`, `taxonLevel`, `taxonFix`, `agency`, `lifestage`, `rarefy`, `rarefyCount`, `sharedTaxa`, `seed` and `boatableStreams.` `dataType` refers to whether the sample by taxa community matrix contains abundance (`dataType = "abun"`) or occurrence (`dataType = "occur"`) values.
Abundance values are densities (number of organisms per m^2^) and occurrence values are presence (1) or absence (0).

`taxonLevel` refers to the taxonomic resolution (Genus, Class, Family, etc.) for the sample by taxa matrix.
The input values for this parameter must start with a capital letter.
All observations taxonomically coarser than the `taxonLevel` provided are dropped from the output community matrix.
For instance, if `taxonLevel = "Genus"` , then observations identified at Family, Order, Class, or Phylum levels are dropped.
"Genus" is the finest level of taxonomic resolution provided for macroinvertebrates.
The package does not provide USGS species-level identifications for two reasons.
First, we limit USGS identification to the genus-level to make the EPA and USGS data comparable.
Second, species-level identifications of some groups of macroinvertebrates are inherently difficult to make, so we limit identifications to the genus-level to avoid potentially inaccurate identifications.

Across the time span of the USGS and EPA macroinvertebrate datasets, the taxonomy of many macroinvertebrates changed, specifically membership of species within genera.
`taxonFix` provides options to harmonize taxonomy through time, especially in instances in which membership of a given organism within a genus is not clear.
In certain scenarios a given organism may have been identified to genus at the lab bench, yet when taxonomic updates occurred, only some species within the originally designated genus moved to a different genus.
This scenario prevents confident identification of a given organism’s “true” genus because it is possible the organism in question might belong to the original genus or the new, updated genus.
For instance, consider an organism identified with the hypothetical genus *Hereiam*.
At the time of the identification, there were only two species within this genus: *Hereiam here* and *Hereiam there*.
In the time since the identification in the lab, the taxonomy has been reorganized, and presently the genus *Hereiam* only contains one species *Hereiam here*, and a new genus has been created.
*Hereiam there* is now *Thereiam there*.
So, it is unclear whether the organism, originally identified as *Hereiam* belongs to *Hereiam* or *Thereiam* because of the updates in taxonomy. This issue is especially difficult to overcome when attempting to harmonize samples that were identified before and after a taxonomic update occurred.

The package provides three options for accounting for these changes in taxonomy through time using the parameter `taxonFix`.
First, the default option, `taxonFix = “lump”`, creates complexes of genera by combining all possible genera for the given organism.
This approach prioritizes retaining observations of organisms by giving a unified name (e.g. genus1/genus2/genus3) to a complex of genera that have been linked through changes in taxonomy through time.
With this approach, there is no temporal increase or decrease in the number of genera, given that individual genera (e.g. genus1) never appear outside of the unified genera name (e.g. genus1/genus2/genus3).
So in the hypothetical example above, *Hereiam* and *Thereiam* would occur as "*Hereiam/Thereiam*" throughout the generated dataset.
In total, 98 genera exist that were linked through changes in taxonomy through time ([Figure 2](#Figure2)).
The approach described above reduces these 98 genera to 13 complexes of genera.
All but two complexes of genera were composed of two individual genera.
A single complex of genera within the Ephemeroptera order included 70 individual genera, and a second complex of Ephemeroptera genera included six individual genera.
Because of the complexity of Ephemeroptera taxonomy, careful consideration should be given to inferences that can be made when evaluating Ephemeroptera trends.
The authors, for instance, do not advise users evaluate temporal changes in abundance or richness of the linked groups of Ephemeroptera genera because taxonomic reorganizations likely obscure temporal patterns.

<br>
<a id="Figure2"></a>

![**Figure 2.** Visualization of the relationships among genera linked by taxonomic reorganization through time. Each numbered circle represents an individual genus. Lines between genera indicate that the taxonomic designation of at least one species from one of the genus pairs was updated to be in the other genus in the pair. Clusters (genera complexes) are formed by sets of these linked genera. See [Appendix Table A1](#TableA1) for table linking numbers in the above cluster to genera names.](https://github.com/mahonmb/Misc/blob/main/GenusClusters.jpg?raw=true){width="350"}

<br>

The second option, `taxonFix = "remove"`, prioritizes accurate identification by dropping observations that cannot be confidently identified to a single genus, which includes the complexes of genera previously described.
In addition, `taxonFix = "remove"` also removes orgnaisms identified as slash genera (e.g. genus1/genus2), which are identifications given to an organism during  identification when multiple genera are not distinguished in an identification key.
So, `taxonFix = "remove"` results in a dataset that has fewer genera compared to a dataset generated with `taxonFix = "lump"`.
`taxonFix = "remove"` is the best option if accurate identification is a high priority for users.

Finally, `taxonFix = "none"` makes no adjustment and returns identifications in their original forms.
The `taxonFix = "none"` option generates slash genera for organisms that are given a slash genus either at the time of identification or to harmonize occurrences of slash genera between USGS and EPA observations, as described above.
Care should be taken to harmonize taxonomy either with the approaches described above or by some alternative when generating long time scale datasets on the entire community of macroinvertebrates because changes in taxonomy can make it artificially appear as though some genera are either appearing or disappearing in time.

`taxonFix` operates on the genus level, so set `taxonFix = "none"` when taxonLevel is set to "Subfamily" or higher taxonomic resolution.
Care should be taken to harmonize taxonomy either with the approaches provided or some alternative when long time scale datasets on the entire community of macroinvertebrates are generated because changes in taxonomy can make it artificially appear as though some genera are either appearing or disappearing in time.
No matter the value provided to `taxonFix`, taxonomy is harmonized in three additional ways to appropriately join USGS and EPA datasets.
First, in instances when a given organism has been identified at the species level and the genus that was originally given at the time of identification has been updated to a new genus, the package updates the genus designation by cross walking the bench identification to the current genus (*Hereiam there* becomes *Thereiam there* from the hypothetical example previously described).
Second, there are instances when a slash genus was not used consistently between USGS and EPA.
Slash genera are designations of multiple genera given to an organism during bench identification when multiple genera are indistinguishable (such as Cricotopus/Orthocladius).
As a hypothetical example, the USGS data contains an organism identified as genus1/genus2, while EPA data included separate identifications of genus1 and genus2.
To ensure consistency between the agencies, the package renames all single instances of genus1 and genus2 to genus1/genus2 when combining the EPA and USGS samples into a single dataset.
Third, within the EPA dataset, a group of chironomids were identified to a genus-group (*Thienemannimyia* genus group), which consists of the chironomid genera *Arctopelopia*, *Conchapelopia*, *Hayesomyia*, *Helopelopia*, *Meropelopia*, *Rheopelopia*, *Telopelopia*, and *Thienemannimyia.*
The package replaces instances of organisms identified to one of these individual genera or the *Thienemannimyia* genus group with a single slash genus, *Arctopelopia/Conchapelopia/Hayesomyia/Helopelopia/Meropelopia/Rheopelopia/Telopelopia/Thienemannimyia*.
Taxonomy dataset used to harmonize was provided by USGS BioData.

`agency` refers to the agency that collected the data.
The default is `c("USGS", "EPA")` and results in the largest dataset.
Users should be aware that the sampling designs (strategies for selecting sampling locations) from each agency are quite different ([Figure 3](#Figure3)).

<br>
<a id="Figure3"></a>
<img src="https://github.com/mahonmb/Misc/blob/main/sitesthrutime.png?raw=TRUE" alt="**Figure 3.** EPA and USGS sampling locations through years for both fish and macroinvertebrates. Sampling locations for USGS are set by research priorities of a given time period and those priorities change through time. The USGS sampling design results in a clustered pattern in some early years, and in later years, sites are more dispersed across the US. The EPA Wadeable Streams Assessment (WSA), which is part of NRSA from 2000-2004, used a randomized sampling design but surveyed only wadeable streams in either eastern or western portions of the US in each year. In all other rounds of the NRSA, a randomized sampling strategy is used across the entirety of the US and included both wadeable and boatable waterbodies, resulting in data that is representative of rivers and streams across the nation." width="550px" style="display: block; margin: auto;" />

<br>

Sampling locations for USGS are set by research priorities of a given time period and assessment, and those priorities change through time. The BioData sampling design results in a clustered pattern in some early years, and in later years, sites are more dispersed throughout the US ([Figure 3](#Figure3)).
Conversely, EPA NARS uses a randomized sampling design to ensure that data collected are representative of water bodies across the contiguous US. The surveys of rivers and streams is called the National Rivers and Streams Assessment (NRSA). Generally, sampling rounds of NRSA occur every five years and each round of sampling occurs across two years ([Figure 3](#Figure3)). An exception is an early iteration of NRSA called the Wadeable Streams Assessment (WSA). From 2000 to 2004, WSA surveyed only wadeable streams in either eastern or western portions of the US in each year.
For more information see the sampling manuals from each of the agencies: [USGS NAWQA](https://pubs.usgs.gov/publication/ofr93406) and [EPA NRSA](https://www.epa.gov/national-aquatic-resource-surveys/manuals-used-national-aquatic-resource-surveys#National%20Rivers%20&%20Streams%20Assessment). Most sites across both EPA and USGS are sampled for a single year, although subsets of sites within each agency have been resampled across years ([Figure 4](#Figure4)).

<br>
<a id="Figure4"></a>

![**Figure 4.** Histograms showing the distributions in the number of unique years sites were sampled for macroinvertebrates and fish by the EPA and USGS. The vast majority of sites are sampled once. There are 60 sites with macroinvertebrates sampled in 10 or more years and 76 sites with fish sampled in 10 or more years from the USGS.](https://github.com/mahonmb/Misc/blob/main/TimesSampledBoth.png?raw=TRUE){width="500"}

<br>

`boatableStreams` provides the option to include data from large streams and rivers that are too deep to sample by wading.
All USGS sampling locations are considered wadeable streams, while EPA samples both wadeable streams and boatable rivers.
As such, `boatableStreams` should only be `TRUE` when `agency` is set to `“EPA”` only, to ensure the highest comparability between the two agency datasets.

`rarefy` provides an option to randomly subsample samples to a user defined number of individuals.
The target number of organisms identified within a sample varies across programs, agencies, time, and space, which introduces variation in output datasets.
Target counts are typically 500 individuals for EPA samples, and they range from 100-600 for USGS samples.
This parameter can be used to account for differences in the number of individuals sampled, which can be useful in the calculation of diversity metrics.
When `rarefy = TRUE`, only samples containing at least `rarefyCount` individuals are retained.
The rarefaction level defaults to 300 individuals, `rarefyCount = 300`, to balance the proportion of the samples dropped that failed to meet the rarefaction level with the addition of genera gained at the rarefaction level ([Figure 5](#Figure5)).
With a rarefaction level of 300, ~91% of samples are retained, and with every 50 individuals identified, \~1 genus is added to the average sample.
So, lowering the threshold to 200 individuals would have removed \~2 genera per sample and would have retained 94.5% of samples.
Similarly, increasing the threshold to 400 individuals would have added \~2 genera per sample but would have retained only 70.6% of samples.

<br>
<a id="Figure5"></a>

![**Figure 5.** Visualization of the relationship between mean number of genera gained, the proportion of samples with at least n number of organisms identified, and the number of organisms identified per sample in all streams, justifying the use of 300 as the default rarefication threshold.](https://github.com/mahonmb/Misc/blob/main/invertRare.png?raw=TRUE){width="350"}

<br>

Use `seed =` and provide an integer to consistently generate output from the function.
This parameter is passed to `set.seed()` internally.
When generating density values, use `dataType = "abun"` and `rarefy = FALSE` (default).

`lifestage` refers to whether the generated site by taxa matrix should include lifestage information for each organism.
If `lifestage = TRUE`, the generated matrix will have separate columns for the various lifestages collected for each taxa.
Lifestage is only provided for the USGS samples.

`sharedTaxa` refers to whether the resulting dataset should retain only taxa that are found by both agencies.
Set `sharedTaxa = FALSE` when generating a dataset for only one agency.
We recommend using `sharedTaxa = TRUE` for building a dataset with both agencies, so that species pools are consistent.


```r
##This code will generate density estimates at the Genus level for all samples
##in USGS BioData. Lifestage information will be ignored.

Inverts <- getInvertData(dataType = "abun",
                         taxonLevel = "Genus",
                         agency = "USGS",
                         lifestage = FALSE,
                         rarefy = FALSE,
                         boatableStreams = FALSE)
```

```
##  Gathering and cleaning USGS raw data                     Applying taxonomy fixes to USGS data                     Finalizing data for output                           finsyncR data synchronization complete
```

```r
head(Inverts)[,1:26]
```

```
##   Agency ProjectLabel           SiteNumber                 StudyReachName CollectionDate CollectionYear CollectionMonth CollectionDayOfYear Latitude_dd Longitude_dd
## 1   USGS  WHMI BioTDB USGS-393259085101200 393259085101200-A-NAWQA-BioTDB     1999-07-13           1999               7                 194    39.54977    -85.16996
## 2   USGS  WHMI BioTDB        USGS-03245500        03245500-A-NAWQA-BioTDB     1999-07-14           1999               7                 195    39.17145    -84.29799
## 3   USGS  WHMI BioTDB        USGS-03246400        03246400-A-NAWQA-BioTDB     1999-07-15           1999               7                 196    39.05895    -84.05132
## 4   USGS  WHMI BioTDB USGS-395534084091400 395534084091400-A-NAWQA-BioTDB     1999-07-07           1999               7                 188    39.92617    -84.15383
## 5   USGS  WHMI BioTDB USGS-395650083504400 395650083504400-A-NAWQA-BioTDB     1999-07-06           1999               7                 187    39.94728    -83.84549
## 6   USGS  WHMI BioTDB USGS-392246084340100 392246084340100-A-NAWQA-BioTDB     1999-07-13           1999               7                 194    39.37950    -84.56689
##   CoordinateDatum    COMID StreamOrder WettedWidth PredictedWettedWidth_m NARS_Ecoregion SampleTypeCode AreaSampTot_m2 FieldSplitRatio LabSubsamplingRatio PropID
## 1           NAD27  3923217           4          NA                  27.88            SAP           IRTH           1.25               1              0.0170 0.0170
## 2           NAD27 25243939           5          NA                  43.55            TPL           IRTH           1.25               1              0.0347 0.0347
## 3           NAD27  3936150           4          NA                     NA            TPL           IRTH           1.25               1              0.0397 0.0397
## 4           NAD27  3985952           5          NA                  46.70            TPL           IRTH           1.25               1              0.0149 0.0149
## 5           NAD27  3985520           5          NA                  28.50            TPL           IRTH           1.25               1              0.0298 0.0298
## 6           NAD27  3885882           7          NA                 100.42            TPL           IRTH           1.25               1              0.0113 0.0113
##   Gen_ID_Prop
## 1   0.8838527
## 2   0.8655914
## 3   0.8084416
## 4   0.7481297
## 5   0.7476923
## 6   0.8468208
##   Acentrella.Acerpenna.Amercaenis.Americabaetis.Anafroptilum.Anthopotamus.Apobaetis.Attenella.Baetis.Baetisca.Barbaetis.Brachycercus.Caenis.Callibaetis.Campsurus.Caudatella.Centroptilum.Choroterpes.Cinygma.Cinygmula.Cloe.Cloeon.Dannella.Dentatella.Diph ...
## 1                                                                                                                                                                                                                                                         3104.8
## 2                                                                                                                                                                                                                                                         1497.6
## 3                                                                                                                                                                                                                                                         2217.6
## 4                                                                                                                                                                                                                                                         2419.2
## 5                                                                                                                                                                                                                                                         1263.2
## 6                                                                                                                                                                                                                                                         1058.4
##   Antocha Cardiocladius.Eukiefferiella.Tvetenia Ceratopsyche.Hydropsyche
## 1    94.4                                1176.0                   7291.2
## 2     0.0                                  68.8                   1659.2
## 3     0.0                                   0.0                     80.0
## 4    53.6                                 107.2                   3332.8
## 5     0.0                                 994.4                   2124.0
## 6     0.0                                   0.0                   1058.4
```

### Using the macroinvertebrate data

Alongside community matrices, `getInvertData()` provides covariate data that describes details of sampling methods.
Two covariates, proportion of sample identified (`PropID`) and area sampled (`AreaSampledTotal_m`), are of particular interest to users because they are used to calculate densities of macroinvertebrates ([Figure 6](#Figure6)) and they represent different facets of sampling effort.

<br>
<a id="Figure6"></a>

![**Figure 6**.Calculation of sample densities for USGS and EPA samples. The field split ratio is the proportion of the field collected sample that is brought into the lab to be identified. Note that only the USGS data included field split ratios. Lab subsampling ratio is the proportion of grids in a subsampling tray used to identify and enumerate macroinvertebrates in the lab.](https://github.com/mahonmb/Misc/blob/main/InvertAbun.png?raw=TRUE){width="525"}

<br>

For macroinvertebrates, density calculations are simply macroinvertebrate abundance divided by the area sampled ([Figure 6](#Figure6)).
Macroinvertebrate abundance is the number of individuals counted in a gridded tray in the lab multiplied by the inverse of the proportion of the sample collected in the field that was identified at the lab bench (`PropID`).
The calculation of `PropID` differs by agency because of differences in splitting samples in the field.
For USGS samples, a proportion of the homogenized field sample is seperated before specimen identification and enumeration in the lab.
This proportion is the “field split ratio” ([Figure 6](#Figure6)).
EPA field samples are not split. For both EPA and USGS the processing of samples in the lab is similar.
In the lab, organisms in a sample are placed uniformly among the grids in a subsampling tray.
Grids are randomly selected and organisms within a given grid are identified until a target organism count is reached.
The proportion of grids used to identify macroinvertebrates at the lab bench is the “lab subsampling ratio”.
For USGS samples, `PropID` is calculated by multiplying the “field split ratio” and the “lab subsampling ratio” ([Figure 6](#Figure6)).
For EPA samples, `PropID` is equal to the “lab subsampling ratio” ([Figure 6](#Figure6)).

Sampling effort is a source of variation and should be considered in the context of research questions because these factors influence sample abundances and probability of detection of any given organism.
For instance, sampling effort varies across sampling events and is also correlated with time in some cases, which could lead to biased interpretation in certain analyses.
Given that `PropID` and `AreaSampledTotal_m` are facets of sampling effort, they influence the number of individuals measured in a sample.
As `PropID` and `AreaSampledTotal_m` increase, the total density of macroinvertebrates decreases, and as time proceeds `PropID` and `AreaSampledTotal_m` increase ([Figure 7](#Figure7)).
Together, these trends suggest the potential that early years could be biased to large sample densities and later years could be biased to low sample densities, which would make it appear as though total densities decline over time.


<br>
<a id="Figure7"></a>

![**Figure 7**. Associations among sampling variables (proportion of the sample identified (`propID`) and area sampled (`AreaSampledTotal_m`)), total macroinvertebrate densities within samples, and time for both EPA and USGS datasets. Trend lines are simple linear relationships between sets of variables. These associations suggest that users should carefully consider these sampling effort variables because ignoring these variables could lead to spurious results in some instances. For instance, as `propID` and `AreaSampledTotal_m` increase, the total density of macroinvertebrates decreases, and as time proceeds `propID` and `AreaSampledTotal_m` increase. Together, these trends suggest the potential that early years could be biased to high density measurements and later years could be biased to low density measurements, which would make it appear as though total densities decline over time.](https://github.com/mahonmb/Misc/blob/main/proparea.png?raw=TRUE){width="550"}

<br>

The proportion of specimen within samples identified to genus (`genPropID`) is a variable that describes potential changes in the ability of taxonomists to identify specimen through time.
Within some orders, Gen_ID_Prop increases over time, likely indicating that taxonomists improved in their abilities to make identifications at the genus or species level, and as a result the probability of detection of these groups would appear to increase through time ([Figure 8](#Figure8)). Users should take care to consider these patterns since they could lead to the false impression that new or more genera appear through time.

<br>
<a id="Figure8"></a>

![**Figure 8**. Plots showing relationships between time and the proportion of specimens identified to genus within samples by order for EPA and USGS datasets. Positive trends likely indicate that within a given order, taxonomists improved in their abilities to make identifications at the genus level.](https://github.com/mahonmb/Misc/blob/main/GenIDPropOrderThruTime.png?raw=TRUE){width="550"}

<br>

## Fish

`getFishData()` retrieves, cleans, and compiles the stream fish datasets collected by USGS and EPA.
Fish species names output by the function are unified and current, such that species that may have had multiple, synonymous names in the raw datasets have been combined and have been replaced with the current scientific name.

The parameters in the `getFishData()` function are `dataType`, `taxonLevel`, `agency`, `standardize`, `hybrids`, `sharedTaxa`, and `boatableStreams.` `dataType` refers to whether the sample by taxa community matrix contains abundance (`dataType = "abun"`) or occurrence (`dataType = "occur"`) values.
Abundance values are counts and occurrence values are presence (1) or absence (0).

`taxonLevel` refers to the taxonomic resolution (Species, Genus, Class, Family, etc.) for the sample by taxa matrix.
The input values for this parameter must start with a capital letter.
All observations taxonomically coarser than the taxonLevel provided are dropped from the output community matrix.
For instance, if `taxonLevel = "Genus"`, then observations identified at Family, Order, Class, or Phylum levels are dropped.
The lowest level of taxonomic identification for fish is `"Species"`, because of inconsistent subspecies identifications.

`agency` refers to the agency that collected the data.
The default is c("USGS", "EPA") and results in the largest dataset.
Users should be aware that the sampling designs (strategies for selecting sampling locations) from each agency are quite different ([Figure 3](#Figure3)).
In addition, the majority of sites are only sampled once ([Figure 4](#Figure4)).
For more information, see the discussion of the agency parameter for `getInvertData()`.

`standardize` refers to whether the abundance values in the community matrix should be standardized by unit effort to account for differences in sampling effort and reach length fished.
Specifically, catch per unit effort, `standardize = "CPUE"`, results in abundances that are divided by the product of sampling effort (e.g. minutes shocked, number of seine hauls, or snorkel transects) and stream length sampled (\ref{eq: 1}).

\begin{equation}
  \tag{eq: 1}
  \label{eq: 1}
  CPUE = \frac{taxa~abundance}{(sampling~effort~*~stream~length~fished~(m))}
\end{equation}

To account for differences in efficacy between shocking, seining, and snorkeling, multigear mean standardization (`standardize = "MGMS"`) is another standardization method provided as an alternative to catch per unit effort (`standardize = "CPUE"`).
When `standardize = "MGMS"`, individual species abundances are standardized for each gear type (e.g., electroshock, seine net, snorkel), as above in CPUE.
Then, for each gear type, the CPUE of all *i* species in each sample *j* is summed, to get Total Catch Per Unit Effort for sample *j* (TCPUE~*j*~, \ref{eq: 2}).

\begin{equation}
\tag{eq: 2}
\label{eq: 2}
TCPUE_j = \sum_{} CPUE_{ij}
\end{equation}

For each gear type, the mean TCPUE is calculated, \eq{\overline{TCPUE}}.
Next, to standardize each gear, CPUE for each taxa *i* is divided by mean TCPUE (\ref{eq: 3}).

\begin{equation}
\tag{eq: 3}
\label{eq: 3}
MSC_{ij} = \frac{CPUE_{ij}}{\overline{TCPUE}}
\end{equation}

MSC~*ij*~ is the mean standardized catch of species *i* in observation *j*.
The units of sampling effort cancel in the calculation of MSC~*ij*~, but patterns of relative abundance of species within and across observations are preserved, which can be important for community analyses (e.g. relative evenness, Bray-Curtis distance calculation).
The function then sums the MSC~*ij*~ among gear types, resulting in a single row of data for each sampling event, regardless of the number of gear types used.
See [Gibson-Reinemer et al. (2017)](https://doi.org/10.1139/cjfas-2016-0003) for more regarding the computation of MGMS.

Users should set standardize to either “`CPUE`" or "`MGMS`" if they are interested in comparing abundance values across sites.
Note: some of the samples lacked information on either stream length sampled or sampling effort.
Therefore, if a user is interested in occurrence (presence/absence) data only, then set `dataType = "occur"` and `standardize = "none"`, which provides an occurrence dataset that contains the samples that are dropped with standardization.

`hybrid` provides the option to exclude fish identified as a hybrid of two species.
Because hybrids are difficult to identify in the field, users should keep the default setting `hybrid = FALSE` if accurate identification is important.

`sharedTaxa` refers to whether the resulting dataset should contain only taxa that are found in both agency datasets.
Set `sharedTaxa = FALSE` when building a dataset with samples collected by one agency.
We recommend using `sharedTaxa = TRUE` when building a dataset with samples collected by both agencies, so that species pools are consistent.

Finally, `boatableStreams` provides the option to include data from large streams and rivers that are too deep to sample by wading. All USGS sampling locations are considered wadeable streams, while EPA samples both wadeable streams and boatable streams and rivers. So, set `boatableStreams` to `TRUE` when `agency` is set to “`EPA`” only, to ensure the highest comparability between the two agency datasets.


```r
##This code will generate occurrences at the Family level for all samples
##in both the USGS and EPA databases.

Fish <- getFishData(dataType = "occur",
                    taxonLevel = "Family",
                    agency = c("USGS", "EPA"),
                    standardize = "none",
                    hybrids = FALSE,
                    boatableStreams = TRUE)
```

```
##  Gathering and cleaning USGS raw data                     Applying taxonomic fixes to USGS data                     Applying count standardization to USGS data                     Gathering, joining, and cleaning EPA raw data                     Applying taxonomic fixes to EPA data
```

```
## Error in `dplyr::mutate()`:
## ℹ In argument: `tax_No fish = ifelse(`tax_No fish` == 0, "Fish Collected", "No Fish Collected")`.
## Caused by error in `ifelse()`:
## ! object 'tax_No fish' not found
```

```r
head(Fish)[,1:28]
```

```
##   Agency ProjectLabel    SiteNumber      StudyReachName CollectionDate CollectionYear CollectionMonth
## 1   USGS     MMSD Eco USGS-04086600 04086600-A-MMSD Eco     2007-09-10           2007               9
## 2   USGS     MMSD Eco USGS-04087030 04087030-A-MMSD Eco     2007-09-05           2007               9
## 3   USGS     MMSD Eco USGS-04087070 04087070-A-MMSD Eco     2007-09-05           2007               9
## 4   USGS     MMSD Eco USGS-04087088 04087088-A-MMSD Eco     2007-09-04           2007               9
## 5   USGS     MMSD Eco USGS-04087119 04087119-A-MMSD Eco     2007-09-12           2007               9
## 6   USGS     MMSD Eco USGS-04087204 04087204-A-MMSD Eco     2007-09-07           2007               9
##   CollectionDayOfYear Latitude_dd Longitude_dd CoordinateDatum    COMID StreamOrder WettedWidth
## 1                 253    43.28028    -87.94250           NAD83 12162572           5          NA
## 2                 248    43.17278    -88.10389           NAD83 12163826           3          NA
## 3                 248    43.12361    -88.04361           NAD83 12163856           3          NA
## 4                 247    43.05472    -88.04611           NAD83 12163882           2          NA
## 5                 255    43.04383    -88.00511           NAD83 12163888           1          NA
## 6                 250    42.92500    -87.87000           NAD83 12168981           2          NA
##   PredictedWettedWidth_m NARS_Ecoregion SampleTypeCode FishCollection ReachLengthFished_m SampleMethod
## 1                  46.17            TPL Large Wadeable Fish Collected                 300        Seine
## 2                   8.98            TPL Small Wadeable Fish Collected                 150        Seine
## 3                   8.50            TPL Small Wadeable Fish Collected                 150        Seine
## 4                   6.72            TPL Small Wadeable Fish Collected                 150        Seine
## 5                   5.12            TPL Small Wadeable Fish Collected                 150        Seine
## 6                   7.26            TPL Small Wadeable Fish Collected                 150        Seine
##   MethodEffort MethodEffort_units Luxilus.cornutus Micropterus.dolomieu Notropis.atherinoides
## 1            3    Number of Hauls                1                    1                     1
## 2            3    Number of Hauls                1                    0                     0
## 3            3    Number of Hauls                1                    0                     0
## 4            5    Number of Hauls                1                    0                     0
## 5            3    Number of Hauls                0                    0                     0
## 6            3    Number of Hauls                0                    0                     0
##   Ambloplites.rupestris Ameiurus.natalis Campostoma.anomalum
## 1                     0                0                   0
## 2                     0                0                   0
## 3                     0                0                   0
## 4                     0                0                   1
## 5                     0                0                   0
## 6                     0                0                   0
```

### Using the fish data

At some sites, no fish were collected despite attempts.
These zero counts for fish are included in the output datasets and are indicated by the `FishCollection` column.

The fish sample by taxa community matrix includes information on both reach length fished (`ReachLengthFished_m`), the sampling method employed (e.g., electrochocking, seining, snorkelling; `SampleMethod`), standardizeand effort values (e.g., minutes of shocking, number of seine hauls, minutes snorkeling; `MethodEffort`), and specific protocol employed (e.g., NRSA small stream, NRSA large stream, etc.; `SampleTypeCode`).
`MethodEffort` and `ReachLengthFished_m` are facets of sampling effort and influence the number of individuals measured in a sample and may be important covariates ([Figure 9](#Figure9)).
However, unlike the macroinvertebrate sampling variables ([Figure 7](#Figure7)), these fish sampling variables vary randomly through time.
There could conceivably be instances in which fish sampling variables are important to consider in analyses given their wide variation and correlation with number of fish within samples.

<br>
<a id="Figure9"></a>

![**Figure 9**. Associations among sampling variables (minutes spent electroshocking [`MethodEffort`] and area sampled [`ReachLengthFished_m`]), catch per unit effort (CPUE), and time for both EPA and USGS datasets. These associations suggest that users should consider these sampling effort variables. For instance, as `MethodEffort` and `ReachLengthFished_m` increase, the total number of fish decreases. However, unlike the macroinvertebrate sampling variables ([Figure 7](#Figure7)), these fish sampling variables randomly vary through time.](https://github.com/mahonmb/Misc/blob/main/propareaFish.png?raw=TRUE){width="550"}

<br>

# Abiotic Dataset: National Land Cover Database from USGS
There is one abiotic function that generates land cover data, `getNLCDData()`.
`getNLCDData()` retrieves land cover data from the National Land Cover Database (NLCD) for sampling sites at the catchment and watershed scales.
This function directly accesses the USEPA StreamCat API ([Hill et al. 2015](https://onlinelibrary.wiley.com/doi/full/10.1111/1752-1688.12372)) to gather NLCD data based on sampling location from NHDPlus COMIDs and collection year.

`getNLCDData()` matches sampling sites to NLCD data in time.
NLCD data are available in the following years: 2001, 2004, 2006, 2008, 2011, 2013, 2016, and 2019.
For instances of samples that do not have a match in collection year to a year of NLCD data, samples are matched to the closest year of NLCD data
For instance, a site sampled in 1995 is matched to 2001 NLCD data.
For samples (e.g. collection year 2005) that fall at the midpoint of two NLCD years (e.g. 2004 and 2006 NLCD data), the function pulls NLCD data from the earlier year (e.g. 2004 NLCD data).

Users can specify whether NLCD data should be extracted at the catchment `Cat` or watershed `Ws` scales.
A watershed is larger than a catchment and includes land that drains downstream of the sampling location, and a catchment includes only land that is upstream of the sampling location.
See [StreamCat](https://www.epa.gov/national-aquatic-resource-surveys/streamcat-dataset) documentation for more information.

NLCD data can be grouped into five broad categories using `group = TRUE`.
These categories include "water" (grouping of all wetland and open water land covers), "urban" (grouping of all urban land use), "forest" (grouping of deciduous, coniferous, and mixed forests land covers), "open" (grouping of shrub, barren land, grassland, and hay/pasture land covers), and "crop" (cultivated crop land use).


```r
dat = data.frame(SiteNumber = "USGS-05276005",
                 CollectionYear = c(2005, 2007, 2009))

getNLCDData(data = dat,
            scale = "Cat",
            group = FALSE)
```

```
##      SiteNumber CollectionYear PCTURBMD_Cat PCTMXFST_Cat PCTHAY_Cat PCTURBLO_Cat PCTSHRB_Cat PCTURBHI_Cat
## 1 USGS-05276005           2005         0.25         1.02      41.31         3.84           0         0.11
## 2 USGS-05276005           2007         0.35         1.02      41.48         3.84           0         0.11
## 3 USGS-05276005           2009         0.46         1.02      41.48         3.91           0         0.11
##   PCTHBWET_Cat PCTCROP_Cat PCTGRS_Cat PCTOW_Cat PCTBL_Cat PCTCONIF_Cat PCTDECID_Cat PCTURBOP_Cat
## 1         2.81       38.56          0         0         0            0         0.46         3.20
## 2         2.64       38.56          0         0         0            0         0.46         3.10
## 3         2.50       38.56          0         0         0            0         0.46         2.92
##   PCTWDWET_Cat
## 1         8.44
## 2         8.44
## 3         8.59
```

```r
##select 10 random samples from the dataset to get LULC data for
set.seed(1)
Fish_forNLCD = Fish[sample(1:1000,10, replace = FALSE),] %>%
  dplyr::select(SiteNumber, CollectionYear)

getNLCDData(data = Fish_forNLCD,
            scale = "Cat",
            group = TRUE)
```

```
##       SiteNumber CollectionYear PctCrop_Cat PctFst_Cat PctOpn_Cat PctUrb_Cat PctWater_Cat
## 1  USGS-01072845           2000        0.00      75.35       8.53       5.30        10.81
## 2  USGS-05318630           1997       89.00       0.40       0.60       5.29         4.70
## 3  USGS-01089743           2000        0.00      55.50       1.16      29.45        13.91
## 4  USGS-05288705           1997        0.03       1.12       2.12      95.04         1.69
## 5  USGS-05082625           1993       69.39       3.81       2.94       5.51        18.35
## 6  USGS-02458150           2001        0.00       8.38       0.67      90.22         0.73
## 7  USGS-08050800           1993        0.00      30.26      63.96       4.30         1.50
## 8  USGS-01096544           2000        0.44      32.19      19.34      25.82        22.20
## 9  USGS-06775900           1993        0.00       2.31      96.99       0.19         0.50
## 10 USGS-01144000           1993        0.00      87.58       5.25       6.66         0.50
```

# Parting words

For metadata on output datasets, check out the "Metadata" vignette `vignettes("Metadata", "finsyncR")`.

We anticipate that this package will grow and change in the coming years.
In particular, as the NRSA continues to sample rivers and streams throughout the contiguous US, we intend to incorporate each new round of sampling into this R package when the newest data are made public.
So, the timespan of these data will grow.

We are indebted to the federal and state biologists and contractors who planned these surveys, collected the samples in the field, and processed and identified samples.
We thank them for their efforts in building these datasets that we consider a national treasure.
We are especially grateful to Sarah Lehmann, Richard Mitchell, Amanda Nahlik, Dave Peck, and Alan Herlihy at USEPA, Travis Schmidt, Scott Grotheer, Robert Zuellig, and Peter Ruhl at USGS for the intellectual support of this work and the many conversations about the nuances of these data.

If you have any questions or any issues with these functions, please post on our Github repository [Github](https://github.com/USEPA/finsyncR/issues) or reach out to Samantha Rumschlag ([rumschlag.samantha\@epa.gov](mailto:rumschlag.samantha@epa.gov){.email}) or Michael Mahon ([mahon.michael\@epa.gov](mailto:mahon.michael@epa.gov){.email}).

<br>

# Appendix

<br>
<a id="TableA1"></a>
**Table A1.** Table linking genus numbers from [Figure 1](#Figure1) to genera names and associated genus cluster.

| Genus Number |            Genus | Group                                                                                                                                                                                                              |
|-----------------:|-----------------:|:-----------------------------------|
|            1 |       Acentrella | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|            2 |        Acerpenna | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|            4 |       Amercaenis | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|            5 |    Americabaetis | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|            6 |     Anafroptilum | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|            8 |     Anthopotamus | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|            9 |        Apobaetis | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           12 |        Attenella | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           13 |           Baetis | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           14 |         Baetisca | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           15 |        Barbaetis | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           16 |     Brachycercus | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           17 |           Caenis | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           18 |      Callibaetis | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           19 |        Campsurus | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           20 |       Caudatella | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           21 |     Centroptilum | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           23 |      Choroterpes | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           24 |          Cinygma | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           25 |        Cinygmula | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           26 |             Cloe | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           27 |           Cloeon | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           29 |         Dannella | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           30 |       Dentatella | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           31 |         Diphetor | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           32 |         Drunella | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           33 |       Ecdyonurus | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           34 |         Ecdyurus | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           37 |          Epeorus | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           38 |         Ephemera | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           39 |      Ephemerella | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           40 |          Ephoron | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           41 |       Eurycaenis | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           42 |     Eurylophella | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           43 |      Euthyplocia | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           44 |         Fallceon | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           48 |     Habrophlebia | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           49 |  Habrophlebiodes | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           50 |       Heptagenia | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           51 |     Heterocloeon | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           52 |        Hexagenia | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           55 |             Iron | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           56 |         Ironodes | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           57 |          Iswaeon | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           58 |      Labiobaetis | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           60 |     Leptophlebia | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           61 |       Leucrocuta | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           64 |      Litobrancha | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           65 |    Maccaffertium | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           66 |        Matriella | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           69 |   Neochoroterpes | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           71 |             Nixe | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           72 |       Palingenia | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           73 |     Paracloeodes | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           74 | Paraleptophlebia | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           75 |        Penelomax | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           80 |        Plauditus | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           82 |      Potamanthus | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           83 |        Procloeon | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           84 |     Pseudocloeon | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           85 |  Raptoheptagenia | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           86 |      Rhithrogena | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           87 |       Serratella | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           88 |        Sparbarus | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           90 |        Stenacron | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           91 |        Stenonema | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           92 |       Susperatus | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           93 |     Teloganopsis | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           94 |        Timpanoga | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|           96 |           Tsalia | 1,2,4,5,6,8,9,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,29,30,<br>31,32,33,34,37,38,39,40,41,42,43,44,48,49,50,51,52,55,56,57,58,60,61,64,<br>65,66,69,71,72,73,74,75,80,82,83,84,85,86,87,88,90,91,92,93,94,96 |
|            3 |      Allenhyphes | 3,11,53,59,95,98                                                                                                                                                                                                   |
|           11 |         Asioplax | 3,11,53,59,95,98                                                                                                                                                                                                   |
|           53 |  Homoleptohyphes | 3,11,53,59,95,98                                                                                                                                                                                                   |
|           59 |      Leptohyphes | 3,11,53,59,95,98                                                                                                                                                                                                   |
|           95 |    Tricorythodes | 3,11,53,59,95,98                                                                                                                                                                                                   |
|           98 |      Vacupernius | 3,11,53,59,95,98                                                                                                                                                                                                   |
|            7 |         Anodonta | 7,97                                                                                                                                                                                                               |
|           97 |      Utterbackia | 7,97                                                                                                                                                                                                               |
|           10 |          Armiger | 10,47                                                                                                                                                                                                              |
|           47 |         Gyraulus | 10,47                                                                                                                                                                                                              |
|           22 |     Ceratopsyche | 22,54                                                                                                                                                                                                              |
|           54 |      Hydropsyche | 22,54                                                                                                                                                                                                              |
|           28 |    Cystobranchus | 28,76                                                                                                                                                                                                              |
|           76 |        Piscicola | 28,76                                                                                                                                                                                                              |
|           35 |        Einfeldia | 35,46                                                                                                                                                                                                              |
|           46 |   Glyptotendipes | 35,46                                                                                                                                                                                                              |
|           36 |           Elimia | 36,81                                                                                                                                                                                                              |
|           81 |       Pleurocera | 36,81                                                                                                                                                                                                              |
|           45 |      Fluminicola | 45,63                                                                                                                                                                                                              |
|           63 |     Lithoglyphus | 45,63                                                                                                                                                                                                              |
|           62 |        Libellula | 62,79                                                                                                                                                                                                              |
|           79 |        Plathemis | 62,79                                                                                                                                                                                                              |
|           67 |          Menetus | 67,68                                                                                                                                                                                                              |
|           68 |     Micromenetus | 67,68                                                                                                                                                                                                              |
|           70 |   Neostempellina | 70,89                                                                                                                                                                                                              |
|           89 |      Stempellina | 70,89                                                                                                                                                                                                              |
|           77 |      Planorbella | 77,78                                                                                                                                                                                                              |
|           78 |       Planorbula | 77,78                                                                                                                                                                                                              |
