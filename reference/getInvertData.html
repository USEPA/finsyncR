<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function generates an occurrence or abundance community matrix for
benthic macroinvertebrates sampled in rivers and streams."><title>Access and harmonize macroinvertebrate data — getInvertData • finsyncR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Access and harmonize macroinvertebrate data — getInvertData"><meta property="og:description" content="This function generates an occurrence or abundance community matrix for
benthic macroinvertebrates sampled in rivers and streams."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">finsyncR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.3.0000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/GettingStarted.html">Getting Started</a>
    <a class="dropdown-item" href="../articles/Metadata.html">Metadata</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Access and harmonize macroinvertebrate data</h1>
      
      <div class="d-none name"><code>getInvertData.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function generates an occurrence or abundance community matrix for
benthic macroinvertebrates sampled in rivers and streams.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">getInvertData</span><span class="op">(</span></span>
<span>  dataType <span class="op">=</span> <span class="st">"occur"</span>,</span>
<span>  taxonLevel <span class="op">=</span> <span class="st">"Genus"</span>,</span>
<span>  taxonFix <span class="op">=</span> <span class="st">"lump"</span>,</span>
<span>  agency <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"USGS"</span>, <span class="st">"EPA"</span><span class="op">)</span>,</span>
<span>  lifestage <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  rarefy <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sharedTaxa <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  boatableStreams <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>dataType</dt>
<dd><p>Output data type for the community matrix, either <code>"abun"</code>
(abundance) or <code>"occur"</code> (occurrence).</p></dd>


<dt>taxonLevel</dt>
<dd><p>Level of taxonomic resolution for the community matrix. Input must be one of:
<code>"Phylum"</code>, <code>"Class"</code>, <code>"Order"</code>,
<code>"Family"</code>, <code>"Genus"</code>, or <code>"Species"</code>.</p></dd>


<dt>taxonFix</dt>
<dd><p>Option to account for changes in taxonomy across time, must be
one of: <code>"none"</code>, <code>"lump"</code>, <code>"remove"</code>. See <code>Details</code>
below for more information.</p></dd>


<dt>agency</dt>
<dd><p>The agency name or names (e.g., "USGS" and "EPA") that are the
source of data for the output community matrix. See <code>Details</code> below for more information.</p></dd>


<dt>lifestage</dt>
<dd><p>logical. For USGS data only, should the output dataset include
lifestage information for each individual?  <code>TRUE</code> or <code>FALSE</code>.</p></dd>


<dt>rarefy</dt>
<dd><p>logical. Should samples be standardized by the number of individuals
identified within each sample? <code>TRUE</code> or <code>FALSE</code>. See <code>Details</code>
below for more information.</p></dd>


<dt>sharedTaxa</dt>
<dd><p>logical. Should Genera be limited to those that appear in
both the EPA and USGS datasets? <code>TRUE</code> or <code>FALSE</code>. Must be set to
<code>FALSE</code> when only one agency is specified.</p></dd>


<dt>seed</dt>
<dd><p>numeric. Set seed for <code>rarefy</code> to get consistent results with each new
iteration of the function. Value gets passed to <code>set.seed</code> internally.</p></dd>


<dt>boatableStreams</dt>
<dd><p>logical. Should EPA boatable streams be included in the
output dataset?  <code>TRUE</code> or <code>FALSE</code>. Note: all USGS streams are wadable.
It is not advisable to include boatable streams when building a dataset including
both EPA and USGS data. Boatable EPA data and wadeable USGS data are not
considered comparable.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A taxa by sample data frame with site, stream reach, and sample information.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>taxonFix</code> provides options to account for changes in taxonomy across time,
especially in instances in which species have been reorganized into new genera.
<code>taxonFix</code> operates on the genera level. <code>taxonFix = "none"</code>
makes no adjustment. <code>taxonFix = "lump"</code> prioritizes retaining observations
by giving a unified genera name to all species and genera that have been linked
through changes in taxonomy through time (e.g. genera1/genera2/genera3). Note:
of 98 problematic genera that exist throughout both datasets,
<code>taxonFix = "lump"</code> results in 13 "lumped" genera. Most new "lumped"
genera are fewer than five "old" genera joined. One "lumped" genera (within
Ephemeroptera) includes 70 unique genera names. So, it is not advisable to
examine changes in Ephemeroptera genera. <code>taxonFix = "remove"</code> prioritizes
accurate identifications of organisms by dropping observations from problematic
genera that do not have species-level identification. Without a species-level
identification, there is no way to assure correct membership in an updated genus.
Organisms with a species-level identification are cross-walked to an updated genus.
NOTE on “slash” genera: When <code>taxonFix = "lump"</code>, these "slash"
genera are rolled into the larger linked genera, as above. <code>taxonFix = "remove"</code>
prioritizes accurate identifications by dropping all slash genera are, including
those organisms identified as a “slash” genus at the bend; this option will
result in many fewer genera in the final dataset. Finally, <code>taxonFix = "none"</code>,
includes "slash" genera, but it does not connect these genera to larger linked genera.
See <code><a href="../articles/GettingStarted.html">vignette("GettingStarted")</a></code> for more information.</p>
<p><code>agency</code> refers to the <code>agency</code> that collected the invertebrate samples.
If you want to use data from both agencies, set <code>agency</code> = c("USGS", "EPA"),
which is the default. For USGS data, sampling data include all USGS BioData
with <code>SampleMethodCode</code> of "BERW", "IRTH", "SWAMP", "EMAP", "CDPHE", and "PNAMP".
Note that by default, only moving waters classified as "wadeable" are
included but setting <code>boatableStreams = TRUE</code> will include observations from
non-wadeable streams. Some information included in the EPA dataset are not
included in the USGS datasets, specifically observed wetted width of the
stream/river.</p>
<p>If <code>rarefy = TRUE</code>, only samples with 300+ individuals identified (raw
count) are retained. Thus, ~17 \<!-- % of samples are removed, as they have &lt;300 -->
individuals sampled. The rarefaction threshold is 300 organisms for each
sampling event, because 1) with every 50 individuals identified, ~1 genera
are added to the sample and 2) 82.8 \<!-- % of samples have at least 300 individuals -->
identified. Thus, lowering the threshold to 200 individuals removed ~2 genera
per sample, but only an additional 8.8 \<!-- % of samples are included (90.1 \\% from 82.8 \\%). -->
Similarly, increasing the threshold to 400 individuals added ~2 genera per
sample, but reduced samples to 30.3 \<!-- % of all samples. Use \code{seed = ...} -->
to get consistent output of community data. See <code><a href="../articles/GettingStarted.html">vignette("GettingStarted")</a></code>
for more information regarding rarefaction. NOTE: <code>rarefy = TRUE</code> can
be used when a user wants occurrence data (presence/absence) OR proportional
data (each taxon represents a certain proportion of a sample). Use
<code>rarefy = FALSE</code> when densities are the measure of interest.</p>
<p>When dataType = “abun”, the function calculates taxa densities from samples
using lab subsampling ratios and area sampled $$Taxa~abundance = n*\frqc{1}{Subsampling~Ratio}$$
where <em>n</em> is the number of specimens identified and <em>Subsampling Ratio</em> is the
proportion of the sample that was identified at the lab bench. For
the USGS dataset, this incorporates both "field split ratio" (proportion of
the sample that was brought into the lab for specimen identification) and
the "lab subsampling ratio" (proportion of grids used to identify invertebrates
at the lab bench). For the EPA datasets, this is just the "lab subsampling ratio", the
proportion of grids used to identify invertebrates at the lab bench. Then,
$$Taxa~density = frac{Taxa~abundance}{Area~sampled~(m^2)}$$ where taxa abundance
is simply divided by area sampled to estimate density. See
<code><a href="../articles/GettingStarted.html">vignette("GettingStarted")</a></code> for more details on the calculation of
taxa densities.</p>
<p>Note: There are 81 sampling events (sampling location - collection
date) with replicate samples (not duplicates). We have left these replicate
samples in the dataset, because some replicates are different in the stream
habitat sampled, which may be of interest for certain ecological questions.
For users who would like to remove these data to reduce potential effects of
replicate samples on their analyses, use
<code>data %&gt;% group_by(Site_Number, CollectionDayOfYear) %&gt;% slice(1)</code> to retain
only one replicate from each sampling event from the dataset.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Mahon, Devin Jones, Samantha Rumschlag, Terry Brown</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">Inverts</span> <span class="op">&lt;-</span> <span class="fu">getInvertData</span><span class="op">(</span>taxonLevel <span class="op">=</span> <span class="st">"Genus"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">RarefyInverts</span> <span class="op">&lt;-</span> <span class="fu">getInvertData</span><span class="op">(</span>taxonLevel <span class="op">=</span> <span class="st">"Genus"</span>,</span></span>
<span class="r-in"><span>                               rarefy <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                               seed <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Mahon, Samantha Rumschlag, Devin Jones, Ethan Brown, Terry Brown, Ryan Hill, Stefan Kunz.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

