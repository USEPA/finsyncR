<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function generates an occurrence or abundance community matrix for
benthic macroinvertebrates sampled in rivers and streams from the US EPA
National Rivers and Streams Assessment and USGS BioData."><title>Access and harmonize macroinvertebrate data — getInvertData • finsyncR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Access and harmonize macroinvertebrate data — getInvertData"><meta property="og:description" content="This function generates an occurrence or abundance community matrix for
benthic macroinvertebrates sampled in rivers and streams from the US EPA
National Rivers and Streams Assessment and USGS BioData."><meta property="og:image" content="https://usepa.github.io/finsyncR/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">finsyncR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/BackCalculation.html">Calculating Abundances, Raw Counts, and Rarefying Raw Counts</a>
    <a class="dropdown-item" href="../articles/GettingStarted.html">Getting Started with finsyncR</a>
    <a class="dropdown-item" href="../articles/Metadata.html">Metadata</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Access and harmonize macroinvertebrate data</h1>
      
      <div class="d-none name"><code>getInvertData.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function generates an occurrence or abundance community matrix for
benthic macroinvertebrates sampled in rivers and streams from the US EPA
National Rivers and Streams Assessment and USGS BioData.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">getInvertData</span><span class="op">(</span></span>
<span>  dataType <span class="op">=</span> <span class="st">"occur"</span>,</span>
<span>  taxonLevel <span class="op">=</span> <span class="st">"Genus"</span>,</span>
<span>  taxonFix <span class="op">=</span> <span class="st">"lump"</span>,</span>
<span>  agency <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"USGS"</span>, <span class="st">"EPA"</span><span class="op">)</span>,</span>
<span>  lifestage <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  rarefy <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  rarefyCount <span class="op">=</span> <span class="fl">300</span>,</span>
<span>  sharedTaxa <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  boatableStreams <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>dataType</dt>
<dd><p>Output data type for the community matrix, either <code>"density"</code>
(density) or <code>"occur"</code> (occurrence).</p></dd>


<dt>taxonLevel</dt>
<dd><p>Level of taxonomic resolution for the community matrix. Input must be one of:
<code>"Phylum"</code>, <code>"Class"</code>, <code>"Order"</code>,
<code>"Family"</code>, <code>"Subfamily"</code>, <code>"Genus"</code>, or <code>"Mixed"</code>.</p></dd>


<dt>taxonFix</dt>
<dd><p>Option to account for changes in taxonomy across time, must be
one of: <code>"none"</code>, <code>"lump"</code>, <code>"remove"</code>. See <code>Details</code>
below for more information.</p></dd>


<dt>agency</dt>
<dd><p>The agency name or names (e.g., "USGS" and "EPA") that are the
source of data for the output community matrix. See <code>Details</code> below for more information.</p></dd>


<dt>lifestage</dt>
<dd><p>logical. For USGS data only, should the output dataset include
lifestage information for each taxa?  <code>TRUE</code> or <code>FALSE</code>. Default
is <code>FALSE</code>.</p></dd>


<dt>rarefy</dt>
<dd><p>logical. Should samples be standardized by the number of individuals
identified within each sample? <code>TRUE</code> or <code>FALSE</code>. See <code>Details</code>
below for more information.</p></dd>


<dt>rarefyCount</dt>
<dd><p>integer. If <code>rarefy = TRUE</code>, the individual count to be used
as the cutoff for rarefaction (standardizing samples by the number of individuals
identified). Default is 300.</p></dd>


<dt>sharedTaxa</dt>
<dd><p>logical. Should Genera be limited to those that appear in
both the EPA and USGS datasets? <code>TRUE</code> or <code>FALSE</code>. Must be set to
<code>FALSE</code> when only one agency is specified. Default is <code>FALSE</code></p></dd>


<dt>seed</dt>
<dd><p>numeric. Set seed for <code>rarefy</code> to get consistent results with each new
iteration of the function. Value gets passed to <code>set.seed</code> internally.</p></dd>


<dt>boatableStreams</dt>
<dd><p>logical. Should EPA boatable streams be included in the
output dataset?  <code>TRUE</code> or <code>FALSE</code>. Note: all USGS streams are wadable.
It is not advisable to include boatable streams when building a dataset including
both EPA and USGS data. Boatable EPA data and wadeable USGS data are not
considered comparable.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A taxa by sample data frame with site, stream reach, and sample information.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>agency</code> refers to the <code>agency</code> that collected the invertebrate samples.
If you want to use data from both agencies, set <code>agency</code> = c("USGS", "EPA"),
which is the default. For USGS data, sampling data include all USGS BioData
with <code>SampleMethodCode</code> of "BERW", "IRTH", "SWAMP", "EMAP", "CDPHE RR", and "PNAMP".
Note that by default, only moving waters classified as "wadeable" are
included but setting <code>boatableStreams = TRUE</code> will include observations from
non-wadeable streams. Some information included in the EPA dataset are not
included in the USGS datasets, specifically observed wetted width of the
stream/river.</p>
<p><code>taxonLevel</code> refers to the taxonomic resolution (Genus, Class, Family, etc.)
for the sample by taxa matrix. The input values for this parameter are case
sensitive and must start with a capital letter. All observations taxonomically
coarser than the <code>taxonLevel</code> provided are dropped from the output community matrix.
For instance, if <code>taxonLevel = "Genus"</code> , then observations identified at
Subfamily, Family, Order, Class, or Phylum levels are dropped. When
<code>taxonLevel = "Subfamily"</code>, for taxa without subfamilies, the Family-level
designation is returned. When <code>taxonLevel = "Subfamily"</code>, for taxa without subfamilies, the Family-level
designation is returned. "Genus" is the finest level of taxonomic resolution
provided for macroinvertebrates. The function also provides the option of returning
the lowest level of taxonomic identification for all specimen (<code>taxonLevel = "Mixed"</code>).</p>
<p><code>taxonFix</code> provides options to account for changes in taxonomy across time,
especially in instances in which species have been reorganized into new genera.
<code>taxonFix</code> operates on the genera level. <code>taxonFix = "none"</code>
makes no adjustment. <code>taxonFix = "lump"</code> prioritizes retaining observations
by giving a unified "slash" genera name to all species and genera that have been linked
through changes in taxonomy through time (e.g. genera1/genera2/genera3). Note:
of 82 problematic genera that exist throughout both datasets,
<code>taxonFix = "lump"</code> results in 11 "lumped" genera. All but two complexes
of genera were composed of two individual genera. A single complex of genera
within the Ephemeroptera order included 70 individual genera, and a second
complex of Ephemeroptera genera included six individual genera. Because of
the complexity of Ephemeroptera taxonomy, careful consideration should be
given to inferences that can be made when evaluating Ephemeroptera trends.
The authors, for instance, do not advise that users evaluate temporal changes
in abundance or richness of the linked groups of Ephemeroptera genera because
taxonomic reorganizations likely obscure temporal patterns.</p>
<p>Alternatively, genera linked by taxonomic reorganization can be removed with
<code>taxonFix = "remove"</code>. This option prioritizes accurate identification by
dropping observations that cannot be confidently identified to a single genus,
as in the complexes of genera previously described.  Without a species-level
identification, there is no way to assure correct membership in an updated genus.
Organisms with a species-level identification are cross-walked to an updated genus.
NOTE on “slash” genera: When <code>taxonFix = "lump"</code>, these "slash"
genera are rolled into the larger linked genera, as above. <code>taxonFix = "remove"</code>
prioritizes accurate identifications by dropping all slash genera are, including
those organisms identified as a “slash” genus in the lab; this option will
result in many fewer genera in the final dataset. Finally, <code>taxonFix = "none"</code>,
includes "slash" genera, but it does not connect these genera to larger linked genera.</p>
<p><code>taxonFix</code> operates on the genus level, so set <code>taxonFix = "none"</code>
when taxonLevel is set to <code>"Family"</code> or higher taxonomic resolution.
Care should be taken to harmonize taxonomy either with the approaches provided
or some alternative when long time scale datasets on the entire community
of macroinvertebrates are generated because changes in taxonomy can make it
artificially appear as though some genera are either appearing or disappearing
in time. See <code><a href="../articles/GettingStarted.html">vignette("GettingStarted")</a></code> for more information.</p>
<p>If <code>rarefy = TRUE</code>, samples with <code>rarefyCount</code>+ individuals
identified (raw count) are retained. Thus, a percentage of samples will be
removed, as they have &lt;<code>rarefyCount</code> individuals sampled. The rarefaction
threshold is default is 300 organisms, because 1) with every 50 individuals
identified, ~1 genera are added to the sample and 2) 91.3 \<!-- % of samples have -->
at least 300 individuals identified. Thus, lowering the threshold to 200
individuals removed ~2 genera per sample, but only an additional 3.2 \<!-- % of -->
samples are included (94.5 \<!-- % from 91.3 \\%). Similarly, increasing the threshold -->
to 400 individuals added ~2 genera per sample, but reduced samples to 70.6 \<!-- % of -->
all samples. Use <code>seed = ...</code>  to get consistent output of community data.
See <code><a href="../articles/GettingStarted.html">vignette("GettingStarted")</a></code> for more information regarding
rarefaction. NOTE: <code>rarefy = TRUE</code> can be used when a user wants
occurrence data (presence/absence) OR proportional data (each taxon represents
a certain proportion of a sample). Use <code>rarefy = FALSE</code> when densities
are the measure of interest.</p>
<p>When dataType = "density", the function calculates taxa densities from samples
using lab subsampling ratios and area sampled
$$Taxa~abundance = n*frac{1}{PropID}$$
$$Taxa~density = frac{Taxa~abundance}{Area~sampled~(m^2)}$$
where <em>n</em> is the number of specimens identified and <em>PropID</em> is the
proportion of the sample that was identified at the lab bench. For
the USGS dataset, this incorporates both "field split ratio" (proportion of
the sample that was brought into the lab for specimen identification) and
the "lab subsampling ratio" (proportion of grids used to identify invertebrates
at the lab bench). For the EPA datasets, this is just the "lab subsampling ratio", the
proportion of grids used to identify invertebrates at the lab bench. See
<code><a href="../articles/GettingStarted.html">vignette("GettingStarted")</a></code> for more details on the calculation of
taxa densities.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Mahon, Devin Jones, Samantha Rumschlag, Terry Brown</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">Inverts</span> <span class="op">&lt;-</span> <span class="fu">getInvertData</span><span class="op">(</span>taxonLevel <span class="op">=</span> <span class="st">"Genus"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">RarefyInverts</span> <span class="op">&lt;-</span> <span class="fu">getInvertData</span><span class="op">(</span>taxonLevel <span class="op">=</span> <span class="st">"Genus"</span>,</span></span>
<span class="r-in"><span>                               rarefy <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                               seed <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Michael Mahon, Samantha Rumschlag, Devin Jones, Ryan Hill, Terry Brown, Ethan Brown, Stefan Kunz.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

